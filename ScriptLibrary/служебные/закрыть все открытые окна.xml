<?xml version="1.0" encoding="UTF-8"?>
<Скрипт Версия="3.3" Наименование="закрыть все открытые окна" Автор="Администратор" АдресИнтернет="" ИдентификаторТеста="закрыть_все_открытые_окна" Severity="Значительная" DefaultAPI="1cClientApp" DefaultBrowser="Chrome" DefaultPort="1539">
	<Logic>
		<Action>закрыть все открытые окна</Action>
		<Description>закрыть все открытые окна</Description>
		<Cost>0</Cost>
		<Preconditions Count="0"/>
		<Effects Count="1">
			<Item>
				<Variable>закрыть все открытые окна</Variable>
				<Value type="Булево">true</Value>
			</Item>
		</Effects>
	</Logic>
	<ТаблицаШагов КоличествоШагов="4">
		<Шаг UID="ea3d3774-27b2-4270-8cc9-f23f51370b44" FUID="ea3d3774-27b2-4270-8cc9-f23f51370b44" BFUID="00000000-0000-0000-0000-000000000000" PUID="00000000-0000-0000-0000-000000000000">
			<Свойства>
				<Активность>true</Активность>
				<Наименование>Подключение к тестируемому приложению</Наименование>
				<Описание/>
				<ТипОбъекта/>
				<ЗаголовокОбъекта/>
				<ЭтоГлавноеОкно>false</ЭтоГлавноеОкно>
				<ИмяПеременной/>
				<Действие>ПодключитьТестируемоеПриложение</Действие>
				<ИмяОбъекта/>
				<ДанныеКартинки>9</ДанныеКартинки>
				<Команда/>
				<ПродолжитьПриОшибке>false</ПродолжитьПриОшибке>
				<OutputText/>
				<CommandRef/>
				<Presentation/>
				<Direction/>
				<RowDescription/>
				<SwitchSelection>false</SwitchSelection>
				<Cancel>false</Cancel>
				<Area/>
				<CustomCodeClient>
					<![CDATA[]]></CustomCodeClient>
				<CustomCodeServer>
					<![CDATA[]]></CustomCodeServer>
				<ПредставлениеДанных/>
				<СвойстваПодключенияКлиентаТестирования/>
				<API/>
				<ИмяКлассаОбъекта/>
				<ИдентификаторОбъекта/>
				<Attribute/>
				<ОдинУровеньВниз>false</ОдинУровеньВниз>
				<ClickX/>
				<ClickY/>
				<xPath/>
				<Интервал>0</Интервал>
				<ИспользоватьВариантыПоиска>false</ИспользоватьВариантыПоиска>
				<ЭтоБлок>false</ЭтоБлок>
				<Library/>
				<ПутьБлокШагов/>
				<Goal/>
				<ИмяПараметра/>
				<ИмяПараметра2/>
				<УсловиеСравнения/>
				<Severity/>
				<ЗначениеПараметра Тип="Строка"/>
			</Свойства>
		</Шаг>
		<Шаг UID="674835ca-d2c8-4744-b740-2bd730757d70" FUID="" BFUID="" PUID="00000000-0000-0000-0000-000000000000">
			<Свойства>
				<Активность>true</Активность>
				<Наименование>Закрываем все открытые окна</Наименование>
				<Описание/>
				<ТипОбъекта/>
				<ЗаголовокОбъекта/>
				<ЭтоГлавноеОкно>false</ЭтоГлавноеОкно>
				<ИмяПеременной/>
				<Действие>Комментарий</Действие>
				<ИмяОбъекта/>
				<ДанныеКартинки>11</ДанныеКартинки>
				<Команда/>
				<ПродолжитьПриОшибке>false</ПродолжитьПриОшибке>
				<OutputText/>
				<CommandRef/>
				<Presentation/>
				<Direction/>
				<RowDescription/>
				<SwitchSelection>false</SwitchSelection>
				<Cancel>false</Cancel>
				<Area/>
				<CustomCodeClient>
					<![CDATA[]]></CustomCodeClient>
				<CustomCodeServer>
					<![CDATA[]]></CustomCodeServer>
				<ПредставлениеДанных/>
				<СвойстваПодключенияКлиентаТестирования/>
				<API>1cClientApp</API>
				<ИмяКлассаОбъекта/>
				<ИдентификаторОбъекта/>
				<Attribute/>
				<ОдинУровеньВниз>false</ОдинУровеньВниз>
				<ClickX/>
				<ClickY/>
				<xPath/>
				<Интервал>0</Интервал>
				<ИспользоватьВариантыПоиска>false</ИспользоватьВариантыПоиска>
				<ЭтоБлок>false</ЭтоБлок>
				<Library/>
				<ПутьБлокШагов/>
				<Goal/>
				<ИмяПараметра/>
				<ИмяПараметра2/>
				<УсловиеСравнения/>
				<Severity/>
				<ЗначениеПараметра Тип="Строка"/>
			</Свойства>
		</Шаг>
		<Шаг UID="95c037c6-6bbc-4691-9d83-a6d4d34146d9" FUID="" BFUID="" PUID="674835ca-d2c8-4744-b740-2bd730757d70">
			<Свойства>
				<Активность>true</Активность>
				<Наименование>Код клиент</Наименование>
				<Описание/>
				<ТипОбъекта/>
				<ЗаголовокОбъекта/>
				<ЭтоГлавноеОкно>false</ЭтоГлавноеОкно>
				<ИмяПеременной/>
				<Действие>ВыполнитьПроизвольныйКодКлиент</Действие>
				<ИмяОбъекта/>
				<ДанныеКартинки>13</ДанныеКартинки>
				<Команда/>
				<ПродолжитьПриОшибке>false</ПродолжитьПриОшибке>
				<OutputText/>
				<CommandRef/>
				<Presentation/>
				<Direction/>
				<RowDescription/>
				<SwitchSelection>false</SwitchSelection>
				<Cancel>false</Cancel>
				<Area/>
				<CustomCodeClient>
					<![CDATA[ЕстьОткрытыеОкна = Истина;
ш=0;  // три цикла - этого достаточно

Пока ш<3 и ЕстьОткрытыеОкна=Истина Цикл
	ш=ш+1;
	
	ВсеОкна = ТестовоеПриложение.НайтиОбъекты(Тип("ТестируемоеОкноКлиентскогоПриложения"),,);
	ЕстьОткрытыеОкна = (ВсеОкна.Количество()<=1);
	Для м_окно=0 по ВсеОкна.Количество() Цикл
	
		активное_окно = ТестовоеПриложение.ПолучитьАктивноеОкно();
		Если активное_окно.НачальнаяСтраница=Истина ИЛИ активное_окно.Основное=Истина Тогда
			Продолжить;
		КонецЕсли;
		// если модаьное окно, то пробуем нажать нет
		Если Найти(активное_окно.Заголовок,"1С:Предприятие") 
		ИЛИ Найти(активное_окно.Заголовок,"1C:Enterprise") Тогда
			кнопка_нет = активное_окно.НайтиОбъект(Тип("ТестируемаяКнопкаФормы"),"Нет");
			Если кнопка_нет<>Неопределено Тогда
				кнопка_нет.Нажать();
			Иначе
				кнопка_отмена = активное_окно.НайтиОбъект(Тип("ТестируемаяКнопкаФормы"),"Отмена");
				Если кнопка_отмена<>Неопределено Тогда
					кнопка_отмена.Нажать();
				КонецЕсли;
			КонецЕсли;
		Иначе
			активное_окно.Закрыть();
		КонецЕсли;
				
	КонецЦикла;
	
КонецЦикла;]]></CustomCodeClient>
				<CustomCodeServer>
					<![CDATA[]]></CustomCodeServer>
				<ПредставлениеДанных/>
				<СвойстваПодключенияКлиентаТестирования/>
				<API>1cClientApp</API>
				<ИмяКлассаОбъекта/>
				<ИдентификаторОбъекта/>
				<Attribute/>
				<ОдинУровеньВниз>false</ОдинУровеньВниз>
				<ClickX/>
				<ClickY/>
				<xPath/>
				<Интервал>0</Интервал>
				<ИспользоватьВариантыПоиска>false</ИспользоватьВариантыПоиска>
				<ЭтоБлок>false</ЭтоБлок>
				<Library/>
				<ПутьБлокШагов/>
				<Goal/>
				<ИмяПараметра/>
				<ИмяПараметра2/>
				<УсловиеСравнения/>
				<Severity/>
				<ЗначениеПараметра Тип="Строка"/>
			</Свойства>
		</Шаг>
		<Шаг UID="8e009032-defa-4c00-9bf9-d0cc1f8fd093" FUID="8e009032-defa-4c00-9bf9-d0cc1f8fd093" BFUID="00000000-0000-0000-0000-000000000000" PUID="00000000-0000-0000-0000-000000000000">
			<Свойства>
				<Активность>true</Активность>
				<Наименование>Отключиться от тестируемого приложения</Наименование>
				<Описание/>
				<ТипОбъекта/>
				<ЗаголовокОбъекта/>
				<ЭтоГлавноеОкно>false</ЭтоГлавноеОкно>
				<ИмяПеременной/>
				<Действие>ЗакрытьТестируемоеПриложение</Действие>
				<ИмяОбъекта/>
				<ДанныеКартинки>10</ДанныеКартинки>
				<Команда/>
				<ПродолжитьПриОшибке>false</ПродолжитьПриОшибке>
				<OutputText/>
				<CommandRef/>
				<Presentation/>
				<Direction/>
				<RowDescription/>
				<SwitchSelection>false</SwitchSelection>
				<Cancel>false</Cancel>
				<Area/>
				<CustomCodeClient>
					<![CDATA[]]></CustomCodeClient>
				<CustomCodeServer>
					<![CDATA[]]></CustomCodeServer>
				<ПредставлениеДанных/>
				<СвойстваПодключенияКлиентаТестирования/>
				<API/>
				<ИмяКлассаОбъекта/>
				<ИдентификаторОбъекта/>
				<Attribute/>
				<ОдинУровеньВниз>false</ОдинУровеньВниз>
				<ClickX/>
				<ClickY/>
				<xPath/>
				<Интервал>0</Интервал>
				<ИспользоватьВариантыПоиска>false</ИспользоватьВариантыПоиска>
				<ЭтоБлок>false</ЭтоБлок>
				<Library/>
				<ПутьБлокШагов/>
				<Goal/>
				<ИмяПараметра/>
				<ИмяПараметра2/>
				<УсловиеСравнения/>
				<Severity/>
				<ЗначениеПараметра Тип="Строка"/>
			</Свойства>
		</Шаг>
	</ТаблицаШагов>
	<ПараметрыСценария КоличествоПараметров="0"/>
</Скрипт>