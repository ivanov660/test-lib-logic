<?xml version="1.0" encoding="UTF-8"?>
<Скрипт Версия="3.3" Наименование="получить представление активного элемента" Автор="Администратор" АдресИнтернет="" ИдентификаторТеста="получить_представление_активного_элемента" Severity="Значительная" DefaultAPI="1cClientApp" DefaultBrowser="Chrome" DefaultPort="1539">
	<Logic>
		<Action>получить представление активного элемента</Action>
		<Description>получить представление активного элемента</Description>
		<Cost>0</Cost>
		<Preconditions Count="0"/>
		<Effects Count="3">
			<Item>
				<Variable>получить представление активного элемента</Variable>
				<Value type="Булево">true</Value>
			</Item>
			<Item>
				<Variable>заголовок активного элемента</Variable>
				<Value type="Строка">*</Value>
			</Item>
			<Item>
				<Variable>представление активного элемента</Variable>
				<Value type="Строка">*</Value>
			</Item>
		</Effects>
	</Logic>
	<ТаблицаШагов КоличествоШагов="5">
		<Шаг UID="d1738815-d540-407b-9f8d-c95e3a14843c" FUID="d1738815-d540-407b-9f8d-c95e3a14843c" BFUID="00000000-0000-0000-0000-000000000000" PUID="00000000-0000-0000-0000-000000000000">
			<Свойства>
				<Активность>true</Активность>
				<Наименование>Подключение к тестируемому приложению</Наименование>
				<Описание/>
				<ТипОбъекта/>
				<ЗаголовокОбъекта/>
				<ЭтоГлавноеОкно>false</ЭтоГлавноеОкно>
				<ИмяПеременной/>
				<Действие>ПодключитьТестируемоеПриложение</Действие>
				<ИмяОбъекта/>
				<ДанныеКартинки>9</ДанныеКартинки>
				<Команда/>
				<ПродолжитьПриОшибке>false</ПродолжитьПриОшибке>
				<OutputText/>
				<CommandRef/>
				<Presentation/>
				<Direction/>
				<RowDescription/>
				<SwitchSelection>false</SwitchSelection>
				<Cancel>false</Cancel>
				<Area/>
				<CustomCodeClient>
					<![CDATA[]]></CustomCodeClient>
				<CustomCodeServer>
					<![CDATA[]]></CustomCodeServer>
				<ПредставлениеДанных/>
				<СвойстваПодключенияКлиентаТестирования/>
				<API/>
				<ИмяКлассаОбъекта/>
				<ИдентификаторОбъекта/>
				<Attribute/>
				<ОдинУровеньВниз>false</ОдинУровеньВниз>
				<ClickX/>
				<ClickY/>
				<xPath/>
				<Интервал>0</Интервал>
				<ИспользоватьВариантыПоиска>false</ИспользоватьВариантыПоиска>
				<ЭтоБлок>false</ЭтоБлок>
				<Library/>
				<ПутьБлокШагов/>
				<Goal/>
				<ИмяПараметра/>
				<ИмяПараметра2/>
				<УсловиеСравнения/>
				<Severity/>
				<ЗначениеПараметра Тип="Строка"/>
			</Свойства>
		</Шаг>
		<Шаг UID="c5e2ace0-c8ea-409b-8eb9-5457e9939823" FUID="c5e2ace0-c8ea-409b-8eb9-5457e9939823" BFUID="00000000-0000-0000-0000-000000000000" PUID="00000000-0000-0000-0000-000000000000">
			<Свойства>
				<Активность>true</Активность>
				<Наименование>Получить активное окно</Наименование>
				<Описание/>
				<ТипОбъекта>ClientApplicationWindow</ТипОбъекта>
				<ЗаголовокОбъекта>Партнеры (Клиенты)</ЗаголовокОбъекта>
				<ЭтоГлавноеОкно>false</ЭтоГлавноеОкно>
				<ИмяПеременной>ОкноПриложенияПартнерыКлиенты</ИмяПеременной>
				<Действие>ПолучитьАктивноеОкно</Действие>
				<ИмяОбъекта/>
				<ДанныеКартинки>2</ДанныеКартинки>
				<Команда/>
				<ПродолжитьПриОшибке>false</ПродолжитьПриОшибке>
				<OutputText/>
				<CommandRef/>
				<Presentation/>
				<Direction/>
				<RowDescription/>
				<SwitchSelection>false</SwitchSelection>
				<Cancel>false</Cancel>
				<Area/>
				<CustomCodeClient>
					<![CDATA[]]></CustomCodeClient>
				<CustomCodeServer>
					<![CDATA[]]></CustomCodeServer>
				<ПредставлениеДанных/>
				<СвойстваПодключенияКлиентаТестирования/>
				<API/>
				<ИмяКлассаОбъекта/>
				<ИдентификаторОбъекта/>
				<Attribute/>
				<ОдинУровеньВниз>false</ОдинУровеньВниз>
				<ClickX/>
				<ClickY/>
				<xPath/>
				<Интервал>0</Интервал>
				<ИспользоватьВариантыПоиска>false</ИспользоватьВариантыПоиска>
				<ЭтоБлок>false</ЭтоБлок>
				<Library/>
				<ПутьБлокШагов/>
				<Goal/>
				<ИмяПараметра/>
				<ИмяПараметра2/>
				<УсловиеСравнения/>
				<Severity/>
				<ЗначениеПараметра Тип="Строка"/>
			</Свойства>
		</Шаг>
		<Шаг UID="5c091d1d-2045-472f-87ef-dd093f431a58" FUID="5c091d1d-2045-472f-87ef-dd093f431a58" BFUID="00000000-0000-0000-0000-000000000000" PUID="c5e2ace0-c8ea-409b-8eb9-5457e9939823">
			<Свойства>
				<Активность>true</Активность>
				<Наименование>Команда : Активизировать</Наименование>
				<Описание/>
				<ТипОбъекта>ClientApplicationWindow</ТипОбъекта>
				<ЗаголовокОбъекта/>
				<ЭтоГлавноеОкно>false</ЭтоГлавноеОкно>
				<ИмяПеременной>ОкноПриложенияПартнерыКлиенты</ИмяПеременной>
				<Действие>Команда</Действие>
				<ИмяОбъекта/>
				<ДанныеКартинки>7</ДанныеКартинки>
				<Команда>Активизировать</Команда>
				<ПродолжитьПриОшибке>false</ПродолжитьПриОшибке>
				<OutputText/>
				<CommandRef/>
				<Presentation/>
				<Direction/>
				<RowDescription/>
				<SwitchSelection>false</SwitchSelection>
				<Cancel>false</Cancel>
				<Area/>
				<CustomCodeClient>
					<![CDATA[]]></CustomCodeClient>
				<CustomCodeServer>
					<![CDATA[]]></CustomCodeServer>
				<ПредставлениеДанных/>
				<СвойстваПодключенияКлиентаТестирования/>
				<API>1cClientApp</API>
				<ИмяКлассаОбъекта/>
				<ИдентификаторОбъекта/>
				<Attribute/>
				<ОдинУровеньВниз>false</ОдинУровеньВниз>
				<ClickX/>
				<ClickY/>
				<xPath/>
				<Интервал>0</Интервал>
				<ИспользоватьВариантыПоиска>false</ИспользоватьВариантыПоиска>
				<ЭтоБлок>false</ЭтоБлок>
				<Library/>
				<ПутьБлокШагов/>
				<Goal/>
				<ИмяПараметра/>
				<ИмяПараметра2/>
				<УсловиеСравнения/>
				<Severity/>
				<ЗначениеПараметра Тип="Строка"/>
			</Свойства>
		</Шаг>
		<Шаг UID="c99f6055-e7a4-46ef-9101-7a39c729e321" FUID="c99f6055-e7a4-46ef-9101-7a39c729e321" BFUID="00000000-0000-0000-0000-000000000000" PUID="c5e2ace0-c8ea-409b-8eb9-5457e9939823">
			<Свойства>
				<Активность>true</Активность>
				<Наименование>Код клиент</Наименование>
				<Описание/>
				<ТипОбъекта/>
				<ЗаголовокОбъекта/>
				<ЭтоГлавноеОкно>false</ЭтоГлавноеОкно>
				<ИмяПеременной/>
				<Действие>ВыполнитьПроизвольныйКодКлиент</Действие>
				<ИмяОбъекта/>
				<ДанныеКартинки>13</ДанныеКартинки>
				<Команда/>
				<ПродолжитьПриОшибке>false</ПродолжитьПриОшибке>
				<OutputText/>
				<CommandRef/>
				<Presentation/>
				<Direction/>
				<RowDescription/>
				<SwitchSelection>false</SwitchSelection>
				<Cancel>false</Cancel>
				<Area/>
				<CustomCodeClient>
					<![CDATA[ТекстЗаголовкаАктивногоЭлемента = "";
ПредставлениеТекущегоЭлемента = "";
АктивноеОкно = ТестовоеПриложение.ПолучитьАктивноеОкно();
СписокПодчиненныхОбъектовАктивногоОкна = АктивноеОкно.ПолучитьПодчиненныеОбъекты();

Для каждого стр из СписокПодчиненныхОбъектовАктивногоОкна Цикл


Попытка
	АктивныйЭлемент = стр.ПолучитьТекущийЭлемент();
	ТекстЗаголовкаАктивногоЭлемента = АктивныйЭлемент.ТекстЗаголовка;
	ПредставлениеТекущегоЭлемента = АктивныйЭлемент.ПолучитьПредставлениеДанных();
Исключение
КонецПопытки;

Попытка
СписокПодчиненныхОбъектовТекущегоЭлемента = стр.ПолучитьПодчиненныеОбъекты();
 Для Каждого стр2 из СписокПодчиненныхОбъектовТекущегоЭлемента Цикл
 
 Попытка
	АктивныйЭлемент2 = стр2.ПолучитьТекущийЭлемент();
	ТекстЗаголовкаАктивногоЭлемента = АктивныйЭлемент2.ТекстЗаголовка;
	ПредставлениеТекущегоЭлемента = АктивныйЭлемент2.ПолучитьПредставлениеДанных();
	Сообщить(ПредставлениеТекущегоЭлемента);
Исключение 
КонецПопытки;

 Попытка
 Если ПредставлениеТекущегоЭлемента="" Тогда
	АктивныйЭлемент2 = стр2.ПолучитьТекущийЭлемент();
	ПредставлениеТекущегоЭлемента = АктивныйЭлемент2.ПолучитьТекстРедактирования();
КонецЕсли;
Исключение 
КонецПопытки;

 
 КонецЦикла;
Исключение
КонецПопытки;

КонецЦикла;

мСцен_УстановитьЗначениеПараметра("ТекстЗаголовкаАктивногоЭлемента",ТекстЗаголовкаАктивногоЭлемента);
мСцен_УстановитьЗначениеПараметра("ПредставлениеТекущегоЭлемента",ПредставлениеТекущегоЭлемента);]]></CustomCodeClient>
				<CustomCodeServer>
					<![CDATA[]]></CustomCodeServer>
				<ПредставлениеДанных/>
				<СвойстваПодключенияКлиентаТестирования/>
				<API>1cClientApp</API>
				<ИмяКлассаОбъекта/>
				<ИдентификаторОбъекта/>
				<Attribute/>
				<ОдинУровеньВниз>false</ОдинУровеньВниз>
				<ClickX/>
				<ClickY/>
				<xPath/>
				<Интервал>0</Интервал>
				<ИспользоватьВариантыПоиска>false</ИспользоватьВариантыПоиска>
				<ЭтоБлок>false</ЭтоБлок>
				<Library/>
				<ПутьБлокШагов/>
				<Goal/>
				<ИмяПараметра/>
				<ИмяПараметра2/>
				<УсловиеСравнения/>
				<Severity/>
				<ЗначениеПараметра Тип="Строка"/>
			</Свойства>
		</Шаг>
		<Шаг UID="ae231bde-8714-4af4-9cc9-571862d869c2" FUID="ae231bde-8714-4af4-9cc9-571862d869c2" BFUID="00000000-0000-0000-0000-000000000000" PUID="00000000-0000-0000-0000-000000000000">
			<Свойства>
				<Активность>true</Активность>
				<Наименование>Отключиться от тестируемого приложения</Наименование>
				<Описание/>
				<ТипОбъекта/>
				<ЗаголовокОбъекта/>
				<ЭтоГлавноеОкно>false</ЭтоГлавноеОкно>
				<ИмяПеременной/>
				<Действие>ЗакрытьТестируемоеПриложение</Действие>
				<ИмяОбъекта/>
				<ДанныеКартинки>10</ДанныеКартинки>
				<Команда/>
				<ПродолжитьПриОшибке>false</ПродолжитьПриОшибке>
				<OutputText/>
				<CommandRef/>
				<Presentation/>
				<Direction/>
				<RowDescription/>
				<SwitchSelection>false</SwitchSelection>
				<Cancel>false</Cancel>
				<Area/>
				<CustomCodeClient>
					<![CDATA[]]></CustomCodeClient>
				<CustomCodeServer>
					<![CDATA[]]></CustomCodeServer>
				<ПредставлениеДанных/>
				<СвойстваПодключенияКлиентаТестирования/>
				<API/>
				<ИмяКлассаОбъекта/>
				<ИдентификаторОбъекта/>
				<Attribute/>
				<ОдинУровеньВниз>false</ОдинУровеньВниз>
				<ClickX/>
				<ClickY/>
				<xPath/>
				<Интервал>0</Интервал>
				<ИспользоватьВариантыПоиска>false</ИспользоватьВариантыПоиска>
				<ЭтоБлок>false</ЭтоБлок>
				<Library/>
				<ПутьБлокШагов/>
				<Goal/>
				<ИмяПараметра/>
				<ИмяПараметра2/>
				<УсловиеСравнения/>
				<Severity/>
				<ЗначениеПараметра Тип="Строка"/>
			</Свойства>
		</Шаг>
	</ТаблицаШагов>
	<ПараметрыСценария КоличествоПараметров="2">
		<Параметр>
			<Имя>ТекстЗаголовкаАктивногоЭлемента</Имя>
			<ТипДанных>Строка</ТипДанных>
			<Значение>Номер</Значение>
			<Функция/>
			<КлиентСервер>false</КлиентСервер>
			<ЗатиратьРодительскиеЗначения>false</ЗатиратьРодительскиеЗначения>
			<ИзПодчиненных>false</ИзПодчиненных>
			<СвязьЛогика>заголовок активного элемента</СвязьЛогика>
		</Параметр>
		<Параметр>
			<Имя>ПредставлениеТекущегоЭлемента</Имя>
			<ТипДанных>Строка</ТипДанных>
			<Значение/>
			<Функция/>
			<КлиентСервер>false</КлиентСервер>
			<ЗатиратьРодительскиеЗначения>false</ЗатиратьРодительскиеЗначения>
			<ИзПодчиненных>false</ИзПодчиненных>
			<СвязьЛогика>представление активного элемента</СвязьЛогика>
		</Параметр>
	</ПараметрыСценария>
</Скрипт>